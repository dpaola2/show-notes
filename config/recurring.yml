# Solid Queue recurring job schedule
# These jobs run automatically on the configured schedule

production:
  # Clear finished Solid Queue jobs to prevent database bloat
  clear_solid_queue_finished_jobs:
    command: "SolidQueue::Job.clear_finished_in_batches(sleep_between_batches: 0.3)"
    schedule: every hour at minute 12

  # Fetch new episodes from all subscribed podcast feeds
  refresh_all_feeds:
    class: RefreshAllFeedsJob
    schedule: every hour

  # Delete episodes that have been in trash for more than 90 days
  cleanup_trash:
    class: CleanupTrashJob
    schedule: every day at 3am

  # Send daily digest email (7 AM Eastern / 12 PM UTC)
  send_daily_digest:
    class: SendDailyDigestJob
    schedule: every day at 12pm

  # Detect and timeout episodes stuck in transcribing/summarizing
  detect_stuck_processing:
    class: DetectStuckProcessingJob
    schedule: every 10 minutes

development:
  # More frequent feed refresh for testing
  refresh_all_feeds:
    class: RefreshAllFeedsJob
    schedule: every 15 minutes

  # Delete old trashed episodes
  cleanup_trash:
    class: CleanupTrashJob
    schedule: every day at 3am

  # Send daily digest (same time as production for consistency)
  send_daily_digest:
    class: SendDailyDigestJob
    schedule: every day at 12pm

  # Detect and timeout episodes stuck in transcribing/summarizing
  detect_stuck_processing:
    class: DetectStuckProcessingJob
    schedule: every 10 minutes
