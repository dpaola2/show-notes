---
pipeline_stage: 4
pipeline_stage_name: test-generation
pipeline_project: "shareable-episode-cards"
pipeline_started_at: "2026-02-18T09:32:04-0500"
pipeline_completed_at: "2026-02-18T09:40:53-0500"
---

# Test Coverage Matrix — Shareable Episode Cards

> Generated by Pipeline Stage 4 (Test Generation)
> Maps every gameplan acceptance criterion to its test location(s).

## M1: Data Model, Public Page & OG Meta Tags

| Criterion ID | Description | Test File | Test Block |
|-------------|-------------|-----------|------------|
| PUB-001 | Public page accessible without auth | `spec/requests/public_episodes_spec.rb` | `PUB-001: public access without authentication` |
| PUB-002 | Displays title, podcast name, artwork | `spec/requests/public_episodes_spec.rb` | `PUB-002: displays episode title, podcast name, and artwork` |
| PUB-003 | Displays full AI summary | `spec/requests/public_episodes_spec.rb` | `PUB-003: displays the full AI summary` |
| PUB-004 | CTA linking to signup | `spec/requests/public_episodes_spec.rb` | `PUB-004: CTA linking to signup` |
| PUB-005 | OG meta tags for rich link previews | `spec/requests/public_episodes_spec.rb` | `PUB-005: OG meta tags for rich link previews` |
| PUB-006 | Clean design with public layout | `spec/requests/public_episodes_spec.rb` | `PUB-006: clean design with public layout` |
| PUB-007 | Management actions not accessible | `spec/requests/public_episodes_spec.rb` | `PUB-007: management actions not accessible from public page` |
| PUB-008 | Stable URL at /e/:id | `spec/requests/public_episodes_spec.rb` | `PUB-008: stable URL at /e/:id` |
| Data model: share_events table | share_events table with indexes | `spec/models/share_event_spec.rb` | `validations`, `associations`, `scopes` |
| Data model: referral_source on users | referral_source column added | `spec/requests/sessions_utm_attribution_spec.rb` | `TRK-004: UTM source persisted through signup flow` |
| Data model: Active Storage tables | Active Storage installed | `spec/models/episode_shareable_spec.rb` | `has one attached og_image` |
| Model: ShareEvent | Validations and associations | `spec/models/share_event_spec.rb` | `validations`, `associations` |
| Model: ShareEvent scopes | for_episode, by_target | `spec/models/share_event_spec.rb` | `scopes` |
| Model: Episode share_events | has_many :share_events | `spec/models/episode_shareable_spec.rb` | `has many share_events` |
| Model: Episode og_image | has_one_attached :og_image | `spec/models/episode_shareable_spec.rb` | `has one attached og_image` |
| Model: Episode og_image_url | og_image_url method | `spec/models/episode_shareable_spec.rb` | `#og_image_url` |
| Model: Episode shareable? | shareable? method | `spec/models/episode_shareable_spec.rb` | `#shareable?` |
| Model: User share_events | has_many :share_events | `spec/models/share_event_spec.rb` | `belongs to user (optional)` |
| Friendly 404 | Non-existent episodes return 404 | `spec/requests/public_episodes_spec.rb` | `friendly 404 for non-existent episodes` |
| No-summary handling | Episodes without summaries handled | `spec/requests/public_episodes_spec.rb` | `episodes without summaries` |
| SEO indexable | robots meta tag | `spec/requests/public_episodes_spec.rb` | `SEO indexable` |

## M2: OG Image Generation

| Criterion ID | Description | Test File | Test Block |
|-------------|-------------|-----------|------------|
| OGI-001 | 1200x630 OG image generated | `spec/services/og_image_generator_spec.rb` | `OGI-001: generates a 1200x630 OG image` |
| OGI-002 | Includes podcast artwork | `spec/services/og_image_generator_spec.rb` | `OGI-002: includes podcast artwork` |
| OGI-003 | Includes episode title | `spec/services/og_image_generator_spec.rb` | `OGI-001: generates a 1200x630 OG image` (implicit — title is input) |
| OGI-004 | Includes quote/excerpt | `spec/services/og_image_generator_spec.rb` | `OGI-004: includes a quote` |
| OGI-005 | Includes Show Notes branding | `spec/services/og_image_generator_spec.rb` | `OGI-001: generates a 1200x630 OG image` (branding is part of generation) |
| OGI-006 | Stored via Active Storage, served via og:image | `spec/jobs/generate_og_image_job_spec.rb` + `spec/requests/public_episodes_spec.rb` | `attaches an OG image` + `OGI-006: og:image served when OG image is attached` |
| OGI-007 | Handles variable artwork quality | `spec/services/og_image_generator_spec.rb` | `OGI-007: handles variable artwork quality` |
| OGI-008 | Triggered on summary creation | `spec/jobs/generate_og_image_job_spec.rb` | `OGI-008: enqueued from ProcessEpisodeJob` |
| Backfill rake task | Generates OG images for existing episodes | N/A | Not testable via spec — rake task verified via manual QA (M4 seed data) |
| OG failure fallback | Failure doesn't break public page | `spec/jobs/generate_og_image_job_spec.rb` | `OG image generation failure does not break things` |
| Missing/broken artwork | Placeholder used | `spec/services/og_image_generator_spec.rb` + `spec/jobs/generate_og_image_job_spec.rb` | `handles variable artwork quality` + `missing artwork URL` |

## M3: Share UI, Tracking & UTM Attribution

| Criterion ID | Description | Test File | Test Block |
|-------------|-------------|-----------|------------|
| SHR-001 | Share button on public + authenticated views | `spec/requests/public_episodes_spec.rb` | `SHR-001: share button on public page` |
| SHR-002 | Copy link to clipboard | N/A | Client-side Stimulus behavior — tested via manual QA |
| SHR-003 | Twitter/X pre-filled tweet | N/A | Client-side Stimulus behavior — tested via manual QA |
| SHR-004 | LinkedIn pre-filled post | N/A | Client-side Stimulus behavior — tested via manual QA |
| SHR-005 | Web Share API on mobile | N/A | Client-side Stimulus behavior — tested via manual QA |
| TRK-001 | UTM params on shared links | N/A | Client-side Stimulus behavior — UTM params added in JavaScript |
| TRK-002 | Share events recorded | `spec/requests/public_episodes_spec.rb` | `TRK-002: share event creation` |
| TRK-003 | UTM visits logged | `spec/requests/public_episodes_spec.rb` | `TRK-003: UTM visit logging` |
| TRK-004 | Signup attribution via referral_source | `spec/requests/sessions_utm_attribution_spec.rb` | `TRK-004: UTM source persisted through signup flow` |
| Debounce clicks | Client-side debounce | N/A | Client-side Stimulus behavior — tested via manual QA |
| Concurrent share POSTs | Server handles gracefully | `spec/requests/public_episodes_spec.rb` | `concurrent share clicks` |

## M4: QA Test Data

| Criterion ID | Description | Test File | Test Block |
|-------------|-------------|-----------|------------|
| Seed task | Idempotent seed data | N/A | Rake task — verified via manual execution during QA |

## M5: Edge Cases, Empty States & Polish

| Criterion ID | Description | Test File | Test Block |
|-------------|-------------|-----------|------------|
| No summary | "Summary not yet available" message | `spec/requests/public_episodes_spec.rb` | `episodes without summaries` |
| OG failure fallback | Text-only OG tags | `spec/requests/public_episodes_spec.rb` | `PUB-005: omits og:image when no OG image is attached` |
| No artwork | Placeholder on OG image + public page | `spec/services/og_image_generator_spec.rb` | `handles missing artwork URL gracefully` |
| Long title | Truncation on OG image | `spec/services/og_image_generator_spec.rb` | `very long episode title` |
| Long quote | Truncation on OG image | `spec/services/og_image_generator_spec.rb` | `very long quote` |
| Deleted episode | Friendly 404 | `spec/requests/public_episodes_spec.rb` | `friendly 404 for non-existent episodes` |
| Summary regenerated | OG image replaced | `spec/jobs/generate_og_image_job_spec.rb` | `replaces the old OG image when regenerated` |
| Concurrent clicks | Debounced client-side | N/A | Client-side Stimulus behavior |
| Social cache | Documented limitation | N/A | No test needed — documented limitation |
| Deactivated user | Public pages still accessible | `spec/requests/public_episodes_spec.rb` | `PUB-001: public access without authentication` (public pages don't reference users) |
| Responsive design | Mobile-friendly | N/A | Visual — verified via manual QA |
| Share popover styling | Consistent with design system | N/A | Visual — verified via manual QA |

## Summary

| Metric | Count |
|--------|-------|
| Total acceptance criteria | 49 |
| Covered by automated tests | 35 |
| Client-side only (manual QA) | 10 |
| Visual/rake task (manual QA) | 4 |
| Test files created | 7 |
| Total test examples | ~55 |
