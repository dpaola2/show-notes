<% content_for(:title) { "#{@episode.title} — #{@podcast.title} | Show Notes" } %>

<% content_for(:head) do %>
  <meta property="og:title" content="<%= @episode.title %>">
  <meta property="og:description" content="<%= @summary ? @summary.sections.first&.dig("content")&.truncate(200) : "Episode summary from #{@podcast.title}" %>">
  <meta property="og:url" content="<%= public_episode_url(@episode) %>">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="Show Notes">
  <% if @episode.og_image.attached? %>
    <meta property="og:image" content="<%= @episode.og_image_url %>">
  <% end %>
<% end %>

<div class="max-w-3xl mx-auto px-4 py-8 sm:py-12">
  <%# Episode header %>
  <div class="flex items-start gap-4 mb-6">
    <% if @podcast.artwork_url.present? %>
      <img src="<%= @podcast.artwork_url %>" alt="<%= @podcast.title %>" class="w-16 h-16 sm:w-20 sm:h-20 rounded-lg shadow-sm object-cover flex-shrink-0">
    <% end %>
    <div>
      <h1 class="text-xl sm:text-2xl font-bold text-gray-900"><%= @episode.title %></h1>
      <p class="text-gray-600 mt-1"><%= @podcast.title %></p>
      <% if @episode.published_at %>
        <p class="text-gray-400 text-sm mt-1"><%= @episode.published_at.strftime("%B %-d, %Y") %></p>
      <% end %>
    </div>
  </div>

  <% if @summary.present? %>
    <%# Summary sections %>
    <div class="space-y-4 sm:space-y-6 mb-8">
      <% @summary.sections.each do |section| %>
        <div class="bg-white p-4 sm:p-6 rounded-lg shadow-sm border border-gray-200">
          <h2 class="font-semibold text-lg mb-2"><%= section["title"] %></h2>
          <p class="text-gray-700 leading-relaxed"><%= section["content"] %></p>
        </div>
      <% end %>
    </div>

    <%# Quotes %>
    <% if @summary.quotes.any? %>
      <div class="space-y-3 mb-8">
        <h2 class="text-lg font-semibold text-gray-900">Notable Quotes</h2>
        <% @summary.quotes.each do |quote| %>
          <blockquote class="border-l-4 border-blue-500 pl-4 py-3 bg-blue-50 rounded-r">
            <p class="text-gray-800">"<%= quote["text"] %>"</p>
          </blockquote>
        <% end %>
      </div>
    <% end %>
  <% else %>
    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-8">
      <p class="text-yellow-800">Summary not yet available</p>
      <p class="text-yellow-600 text-sm mt-1">This episode is still being processed. Check back soon.</p>
    </div>
  <% end %>

  <%# Share placeholder %>
  <div class="mb-8" data-share-url="<%= public_episode_url(@episode) %>">
    <button class="inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-sm font-medium">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
      </svg>
      share
    </button>
  </div>

  <%# CTA %>
  <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 sm:p-8 text-center">
    <h2 class="text-lg sm:text-xl font-bold text-gray-900 mb-2">Get AI summaries for your podcasts</h2>
    <p class="text-gray-600 mb-4">Show Notes delivers concise, AI-powered summaries so you can read the key insights in minutes.</p>
    <%= link_to "Get started — it's free", login_path, class: "inline-block px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition" %>
  </div>
</div>
